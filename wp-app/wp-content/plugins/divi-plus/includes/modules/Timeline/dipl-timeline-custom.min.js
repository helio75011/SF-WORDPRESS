jQuery(document).ready(function(i){function e(e){var t=e.find(".dipl_timeline_item").first().innerHeight()/2,d="calc( 100% - "+(t+e.find(".dipl_timeline_item").last().innerHeight()/2+"px")+" )",l=t+"px";e.find(".dipl_stem_wrapper").css("height",d),e.find(".dipl_stem_wrapper").css("top",l);var n=e.find(".dipl_timeline_item:first-child .dipl_stem_center").offset().top,_=e.find(".dipl_timeline_item:last-child .dipl_stem_center").offset().top,p=screen.height/2;parseFloat(i(this).find(".dipl_stem_wrapper").outerWidth()),e.find(".dipl_timeline_item:first-child").offset().top;if(n<p){var s=e.find(".dipl_stem_wrapper").innerHeight(),r=p-_<_-n-10?p-n+"px":_-n-10+"px";e.find(".dipl_stem").css("height",r),e.find(".dipl_stem_center").each(function(){i(this).offset().top<p&&(i(this).find(".dipl_item_icon").addClass("dipl_icon_fill"),i(this).find(".dipl_time_wrapper").addClass("dipl_border_fill"))}),i(window).height()>=i(document).height()&&(e.find(".dipl_stem").css("height",s),e.find(".dipl_stem_center").each(function(){i(this).find(".dipl_item_icon").addClass("dipl_icon_fill"),i(this).find(".dipl_time_wrapper").addClass("dipl_border_fill")}))}i(window).on("scroll",function(){var t=e.find(".dipl_stem_wrapper").innerHeight(),d=i(window).scrollTop(),l=d+(p-n)+"px";parseFloat(l)<parseFloat(t)&&e.find(".dipl_stem").css("height",l),e.find(".dipl_timeline_item").each(function(){var e=i(this).find(".dipl_stem_center"),t=parseFloat(e.innerHeight());e.offset().top<p+d+t?(e.find(".dipl_item_icon").addClass("dipl_icon_fill"),e.find(".dipl_time_wrapper").addClass("dipl_border_fill")):(e.find(".dipl_item_icon").removeClass("dipl_icon_fill"),e.find(".dipl_time_wrapper").removeClass("dipl_border_fill"))}),i(window).scrollTop()+i(window).height()>i(document).height()-50&&(e.find(".dipl_stem").css("height",t),e.find(".dipl_stem_center .dipl_item_icon").addClass("dipl_icon_fill"),e.find(".dipl_stem_center .dipl_time_wrapper").addClass("dipl_border_fill"))})}jQuery("body").find(".dipl_timeline").length>0&&(i(window).resize(function(){i("body").find(".dipl_timeline").each(function(){var t=i(this);t.find(".dipl_timeline_item").length>0&&e(t)})}),i("body").find(".dipl_timeline").each(function(){var t=i(this);t.find(".dipl_timeline_item").length>0&&(e(t),t.find(".dipl_timeline_right .dipl_date_tree").length>0&&t.find(".dipl_timeline_right .dipl_date_tree").each(function(){var e,d,l=[];i(this).find(".dipl_stem_center").each(function(){var e=parseFloat(i(this).outerWidth());l.push(e)}),e=Math.max.apply(Math,l),t.find(".dipl_stem_center").length>0&&i(this).find(".dipl_stem_center").css("width",e),d=e/2,t.find(".dipl_stem_wrapper").css("left",d)}),t.find(".dipl_timeline_left .dipl_date_tree").length>0&&t.find(".dipl_timeline_left .dipl_date_tree").each(function(){var e,d,l=[];i(this).find(".dipl_stem_center").each(function(){var e=parseFloat(i(this).outerWidth());l.push(e)}),e=Math.max.apply(Math,l),t.find(".dipl_stem_center").length>0&&i(this).find(".dipl_stem_center").css("width",e),d=e/2,t.find(".dipl_stem_wrapper").css("right",d)}))}))});